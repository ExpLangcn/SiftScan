# SiftScan

<p align="center">
  <a href="./README.md">English</a> •
  <a href="https://twitter.com/ExpLang_Cn">@ExpLang_Cn</a>
</p>

SiftScan是一个集成资产识别、资产梳理、资产收集、弱点检测、漏洞检测等的工具。它致力于提高红蓝对抗/脆弱性赏金的效率。

## 使用说明

### Config.yaml

```yaml
Control:
  IsHttp: false # HTTP(s)都保存（有一些网站的 http 和 https 服务是不同业务）
  RespStCode: [200,301,302,403,404] # 响应码白名单
  Timeout: 10 # 请求超时时间

ICPApi:
  GetICP: "" # 域名获取单位信息的 API
  GetDomain: "" # 单位名称获取域名信息 API

FOFA:
  Enable: true
  Email: ""
  APIKey: ""
  Size: "10000"
  Full: true
  IfHost: true # 是否筛选子域名（只输出和主域名符合的主域名，如果为 false 则误报较多）

Zoomeye:
  Enable: true
  APIKEY: ""
  AssociatedDomain: false # 是否搜索关联资产（资产多，误报多，如果为 true 则误报较多）

Hunter:
  Enable: true
  IsWeb: 3 # 1: 代表”web资产“，2: 代表”非web资产“，3: 代表”全部“
  APIKEY: ""
  Size: 100 # 采集的数量，注意：耗费积分！
  AccurateSearch: true # 是否精准搜索 (如果为 false 则误报较多)

Subdomain:
  Enable: true
  IsWildcard: true # 判断是否泛解析
  Dictionary: "simple" # 子域名字典: simple (简单字典) or  (完整字典)
  Silent: true # 是否只输出域名
  Concurrency: 100 # 爆破并发（越高越占用网络）

PortScan:
  PortList: ["1","7","9","13","19","21","22","23","25","37","42","49","53","69","79","80","81","85","105","109","110","111","113","123","135","137","138","139","143","161","179","222","264","384","389","402","407","443","444","445","446","465","500","502","512","513","514","515","523","524","540","548","554","587","617","623","689","705","771","783","873","888","902","910","912","921","993","995","998","1000","1024","1030","1035","1090","1098","1099","1100","1101","1102","1103","1128","1129","1158","1199","1211","1220","1234","1241","1300","1311","1352","1433","1434","1435","1440","1494","1521","1530","1533","1581","1582","1604","1720","1723","1755","1811","1900","2000","2001","2049","2082","2083","2100","2103","2121","2199","2207","2222","2323","2362","2375","2380","2381","2525","2533","2598","2601","2604","2638","2809","2947","2967","3000","3037","3050","3057","3128","3200","3217","3273","3299","3306","3311","3312","3389","3460","3500","3628","3632","3690","3780","3790","3817","4000","4322","4433","4444","4445","4659","4679","4848","5000","5038","5040","5051","5060","5061","5093","5168","5247","5250","5351","5353","5355","5400","5405","5432","5433","5498","5520","5521","5554","5555","5560","5580","5601","5631","5632","5666","5800","5814","5900","5901","5902","5903","5904","5905","5906","5907","5908","5909","5910","5920","5984","5985","5986","6000","6050","6060","6070","6080","6082","6101","6106","6112","6262","6379","6405","6502","6503","6504","6542","6660","6661","6667","6905","6988","7001","7021","7071","7080","7144","7181","7210","7443","7510","7579","7580","7700","7770","7777","7778","7787","7800","7801","7879","7902","8000","8001","8008","8014","8020","8023","8028","8030","8080","8081","8082","8087","8090","8095","8161","8180","8205","8222","8300","8303","8333","8400","8443","8444","8503","8800","8812","8834","8880","8888","8889","8890","8899","8901","8902","8903","9000","9002","9060","9080","9081","9084","9090","9099","9100","9111","9152","9200","9390","9391","9443","9495","9809","9810","9812","9813","9814","9815","9855","9999","10000","10001","10008","10050","10051","10080","10098","10162","10202","10203","10443","10616","10628","11000","11099","11211","11234","11333","12174","12203","12221","12345","12397","12401","13364","13500","13838","14330","15200","16102","17185","17200","18881","19300","19810","20010","20031","20034","20101","20111","20171","20222","22222","23472","23791","23943","25000","25025","26000","26122","27000","27017","27888","28222","28784","30000","30718","31001","31099","32764","32913","34205","34443","37718","38080","38292","40007","41025","41080","41523","41524","44334","44818","45230","46823","46824","47001","47002","48899","49152","50000","50001","50002","50003","50004","50013","50500","50501","50502","50503","50504","52302","55553","57772","62078","62514","65535","82","83","84","86","88","89","90","91","99","800","801","808","880","889","1010","1980","2018","2019","3505","6677","7000","7002","7003","7005","7007","7070","7200","7890","8002","8003","8004","8006","8009","8010","8011","8012","8016","8042","8053","8060","8069","8070","8083","8084","8085","8086","8088","8089","8091","8099","8100","8118","8123","8172","8181","8200","8243","8251","8280","8281","8360","8484","8500","8879","8881","8983","8989","9001","9043","9085","9091","9800","9981","10002","10003","12443","15672","16080","18080","18082","18091","18092","20720","28017","38501","38888"]
  Concurrency: 100 # 爆破并发（越高越占用网络）
  WeakCheck: true # 是否弱项检测,（例：Redis 空口令等）

Craw:
  Depth: 5 # 爬虫深度
  Retries: 3 # 请求重试次数
  Strategy: "depth-first" # 爬虫策略: depth-first (深度优先) or breadth-first (广度优先)
  ShowBrowser: false # 是否展示浏览器爬虫过程
  OutputFile: "" # 爬虫结果输出文件，为空不输出
  Concurrency: 10 # 目标并发数
  Parallelism: 25 # 同时处理 Urls 的数
  RateLimit: 200 # 速率限制: 每秒发送请求的最大数量
  ExtensionFilter: # 指定过滤的后缀
    - "css"
    - "jpg"
    - "png"
    - "gif"
    - "ico"
    - "webp"
    - "mp3"
    - "mp4"
    - "ttf"
    - "tif"
    - "tiff"
    - "woff"
    - "woff2"
```

### 参数

```bash
[SiftScan] 致力于提高红色和蓝色对抗/漏洞赏金的效率. By: Explang｜Twitter: @ExpLang_Cn

Usage:
  SiftScan [flags]

Flags:
      --ai string       智能扫描，输入目标 Url，目标可以是 IP|域名|子域名|URL，程序会自动识别目标类型构建扫描流程并进行扫描
      --debug           Debug 模式
  -h, --help            help for GoScan
  -m, --mode string     爬行模式，simple/smart/strict，默认smart (default "smart")
      --proxy string    请求的代理，针对访问URL在墙外的情况，默认直连为空
  -t, --target string   执行爬行的单个URL
```

### 参考

#### 扫描目标文件

自动过滤目标类型，使用`--ai`参数指定目标文件。

```bash
ExpLang ⚡ cat target.txt
	http://www.xxx.com
	120.xxx.xxx.231
	xxx科技有限责任公司
ExpLang ⚡ ./SiftScan --ai target.txt
```

#### 扫描指定的目标

自动过滤目标类型，并使用“-t”参数来指定目标信息。

```bash
ExpLang ⚡ ./SiftScan -t "xxx科技有限责任公司"
ExpLang ⚡ ./SiftScan -t "120.xxx.xxx.231"
ExpLang ⚡ ./SiftScan -t "http://www.xxx.com"
```

#### 指定爬行模式

```bash
ExpLang ⚡ ./SiftScan -t "xxx科技有限责任公司" -m simple
ExpLang ⚡ ./SiftScan -t "120.xxx.xxx.231" -m smart
ExpLang ⚡ ./SiftScan -t "http://www.xxx.com" -m strict
```

## 开发进展

### 资产收集

- [x] 连接FOFA API接口收集资产，支持主域收集资产，IP收集资产，单位ICP记录号收集资产。
- [x] 连接到Zoomeye API界面以收集资产，支持主域以收集资产，以及IP以收集资产。
- [x] 连接Hunter API接口以收集资产，并支持主域收集资产、IP收集资产、单位名称以收集资产和单位ICP记录号以收集资产。
- [x] 主要域名的子域名的枚举和爆炸。
- [x] IP和子域的WEB标题和服务的端口检测和识别。
  - [x] HTTP
  - [x] REDIS
  - [x] SSH
  - [x] MQTT3
  - [x] MODBUS
  - [x] VNC
  - [x] TELNET
  - [x] MQTT5
  - [x] FTP
  - [x] RSYNC
  - [x] SMB
  - [x] RPC
  - [x] DNS
  - [x] OracleDB
  - [x] SMTP
  - [x] RTSP
  - [x] PostgreSQL
  - [x] MQTT5
  - [x] RDP
  - [x] HTTPS
  - [x] POP3
  - [x] SMTPS
  - [x] KAFKA
  - [x] MQTT3
  - [x] MySQL
  - [x] RDP
  - [x] MSSQL
  - [x] POP3S
  - [x] LDAP
  - [x] LDAPS
  - [x] IMAP
  - [x] IMAPS
  - [x] SNMP
  - [x] Kafka
  - [x] OPENVPN
  - [x] NETBIOS-NS
  - [x] IPSEC
  - [x] DHCP
  - [x] STUN
  - [x] NTP
  - [x] DNS

### 爬虫

- [x] 支持重试
- [x] 爬行深度配置

### 弱点检测

- [ ] 服务的弱点检测
  - [ ] Redis空密码
  - [ ] ...
- [ ] 网络指纹识别
- [ ] 基于Web指纹检测Nuclei模板

⚠️ **如果您对功能有更好的建议，您可以通过[issues](https://github.com/ExpLangcn/SiftScan/issues)详细解释您的需求！**

## 参考资料

🌟 **该顺序不代表任何排名。**

[**Fingerprintx**](https://github.com/praetorian-inc/fingerprintx)

[**NucleiTP**](https://github.com/ExpLangcn/NucleiTP)

[**Nuclei**](https://github.com/projectdiscovery/nuclei)

[**Katana**](https://github.com/projectdiscovery/katana)

[**Fofa**](https://fofa.info/)

[**Zoomeye**](https://www.zoomeye.org/)

[**Hunter**](https://hunter.qianxin.com/)

[**Chinaz**](https://www.chinaz.net/)
